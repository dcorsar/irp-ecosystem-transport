ObservationQueries.baseNs=http://dtp-24.sncs.abdn.ac.uk:8093/observation/

#  observation create - expects: value uri, optional location triples (accuracy, heading, speed), lat, long, easting, northing, sensor output uri, value uri, observation URI, sensor output URI, optional sensing method used triple, featureOfInterest Uri, observed by URI,  observation result time, observation sampling time, server timestamp
ObservationQueries.locationDevice.update.create=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/> INSERT DATA {  <%s> a irpsens:LocationDeviceValue;  %s  geo:lat "%s"^^xsd:double;  geo:long "%s"^^xsd:double;   spatialrelations:easting "%s"^^xsd:double;  spatialrelations:northing "%s"^^xsd:double. <%s> a irpsens:LocationDeviceSensorOutput;  ssn:hasValue <%s>.  <%s> a irpsens:LocationDeviceObservation;  ssn:observationResult <%s>;  %s  ssn:featureOfInterest <%s>;  ssn:observedBy <%s>;  ssn:observationResultTime "%s"^^xsd:long;  ssn:observationSamplingTime "%s"^^xsd:long;  irpsens:serverTimestamp "%s"^^xsd:long.}
# create observation accuracy
ObservationQueries.locationDevice.update.create.accuracy=irpsens:accuracy "%s"^^xsd:double;  
# create observation heading
ObservationQueries.locationDevice.update.create.heading=irpsens:heading "%s"^^xsd:double; 
# create observation speed
ObservationQueries.locationDevice.update.create.speed=irpsens:speed "%s"^^xsd:double;
# create observation sensing method used
ObservationQueries.locationDevice.update.create.sensingMethodUsed= ssn:sensingMethodUsed <%s>; 

# delete observation accuracy - expects observation uri
ObservationQueries.locationDevice.update.delete.observation.accuracy=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> DELETE {     ?value irpsens:accuracy ?accuracy.} WHERE {     <%s> a irpsens:LocationDeviceObservation;     ssn:observationResult/ssn:hasValue ?value.     ?value irpsens:accuracy ?accuracy.}
# delete observation heading - expects observation uri
ObservationQueries.locationDevice.update.delete.observation.heading=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> DELETE {     ?value irpsens:heading ?heading.} WHERE {     <%s> a irpsens:LocationDeviceObservation;     ssn:observationResult/ssn:hasValue ?value.     ?value irpsens:heading ?heading.}
# delete observation speed - expects observation uri
ObservationQueries.locationDevice.update.delete.observation.speed=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> DELETE {     ?value irpsens:speed ?speed.} WHERE {     <%s> a irpsens:LocationDeviceObservation;     ssn:observationResult/ssn:hasValue ?value.     ?value irpsens:speed ?speed.}
# delete observation sensing method used - expects observation uri twice
ObservationQueries.locationDevice.update.delete.observation.sensingMethodUsed=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> DELETE { <%s> ssn:sensingMethodUsed ?method.} WHERE { <%s> a irpsens:LocationDeviceObservation; ssn:sensingMethodUsed ?method.}
# delete observation - expects observation uri
ObservationQueries.locationDevice.update.delete.observation=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/> DELETE {   ?value a irpsens:LocationDeviceValue;  geo:lat ?lat;  geo:long ?long;   spatialrelations:easting ?easting;  spatialrelations:northing ?northing. ?output a irpsens:LocationDeviceSensorOutput;  ssn:hasValue ?value.  <%s> a irpsens:LocationDeviceObservation;  ssn:observationResult ?output;  ssn:featureOfInterest ?foi;  ssn:observedBy ?observer;  ssn:observationResultTime ?obsRT;  ssn:observationSamplingTime ?obsST;  irpsens:serverTimestamp ?serverT. } WHERE {     ?value a irpsens:LocationDeviceValue;  geo:lat ?lat;  geo:long ?long;   spatialrelations:easting ?easting;  spatialrelations:northing ?northing;  irpsens:accuracy ?accuracy. ?output a irpsens:LocationDeviceSensorOutput;  ssn:hasValue ?value.  <%s> a irpsens:LocationDeviceObservation;  ssn:observationResult ?output;  ssn:featureOfInterest ?foi;  ssn:observedBy ?observer;  ssn:observationResultTime ?obsRT;  ssn:observationSamplingTime ?obsST;  irpsens:serverTimestamp ?serverT.   }


#PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> DELETE {     ?value irpsens:accuracy ?accuracy.} WHERE {     <%s> a irpsens:LocationDeviceObservation;     ssn:observationResult/ssn:hasValue ?value.     ?value irpsens:accuracy ?accuracy.}


#PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> DELETE { ?value a irpsesns:LocationDeviceValue; geo:lat ?lat; geo:long ?long; irpsens:gpsTime ?gpsTime; irpsens:deviceTime ?deviceTime; irpsens:serverTime ?serverTime; irpsens:heading ?heading; irpsens:speed ?speed. ?output a irpsens:LocationSensorOutput;	ssn:hasValue ?value. <%s> a irpsens:LocationObservation; ssn:featureOfInterest ?foi; ssn:observedBy ?observer; ssn:sensingMethodUsed ?method; ssn:observationResult ?output.} WHERE { ?value a irpsens:LocationDeviceValue; geo:lat ?lat;  geo:long ?long;irpsens:gpsTime ?gpsTime; irpsens:deviceTime ?deviceTime;irpsens:serverTime ?serverTime;irpsens:accuracy ?accuracy;  irpsens:heading ?heading;  irpsens:speed ?speed. ?output a irpsens:LocationSensorOutput; ssn:hasValue ?value. <%s> a irpsens:LocationObservation; ssn:featureOfInterest ?foi;  ssn:observedBy ?observer; ssn:sensingMethodUsed ?method; ssn:observationResult ?output.}



# get location device observation - expects observationUri four times
ObservationQueries.locationDevice.query.get.observation=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX prov: <http://www.w3.org/ns/prov#> SELECT ?result ?foi ?observedBy ?sensingMethodUsed ?osbservationResultTime ?observationSamplingTime ?serverTime ?derivedFrom WHERE{ <%s> ssn:observationResult ?result;  ssn:featureOfInterest ?foi;  ssn:observationResultTime ?osbservationResultTime;ssn:observationSamplingTime ?observationSamplingTime; irpsens:serverTimestamp ?serverTime. optional {<%s> ssn:observedBy ?observedBy.} optional {<%s> prov:wasDerivedFrom ?derivedFrom.} optional {<%s> ssn:sensingMethodUsed ?sensingMethodUsed.}}


# get location device sensor output - expects LocationSensorOutput URI       
ObservationQueries.locationDevice.query.get.sensorOutput=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> SELECT ?value WHERE {  <%s> ssn:hasValue ?value.}
 
 # get location device value - expects LocationDeviceValue URI five times
ObservationQueries.locationDevice.query.get.observationValue=PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/> SELECT ?latitude ?longitude ?easting ?northing ?accuracy ?heading ?speed ?obs ?distanceMoved WHERE{ <%s> geo:lat ?latitude; geo:long ?longitude; spatialrelations:easting ?easting; spatialrelations:northing ?northing.  optional {<%s> irpsens:distanceMoved ?distanceMovied.} optional {<%s> irpsens:accuracy ?accuracy.} optional {<%s> irpsens:heading ?heading.} optional {<%s> irpsens:speed ?speed.}  } 


# get location device value for an location device observation - expects location device observation uri
ObservationQueries.locationDevice.query.get.outputValueForObservation=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/> SELECT ?latitude ?longitude ?easting ?northing ?accuracy ?heading ?speed ?value ?distanceMoved WHERE {   <%s> a irpsens:LocationDeviceObservation; ssn:observationResult/ssn:hasValue ?value. ?value a irpsens:LocationDeviceValue; geo:lat ?latitude; geo:long ?longitude; spatialrelations:easting ?easting; spatialrelations:northing ?northing. optional {?value irpsens:accuracy ?accuracy.}  	 optional {?value irpsens:heading ?heading.} optional {?value irpsens:speed ?speed.} optional {?value irpsens:distanceMoved ?distanceMovied.}}


# the type for the device location observation
ObservationQueries.type.locationDeviceObservation=LocationDeviceObservation

#  gets the latest report from a particular user: lineUri, direction
#ObservationQueries.locationDevice.get.line.userLatest=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> PREFIX user: <http://www.dotrural.ac.uk/irp/uploads/ontologies/user/>PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/> PREFIX transit: <http://vocab.org/transit/terms/> PREFIX transport: <http://www.dotrural.ac.uk/irp/uploads/ontologies/transport/>SELECT  ?serverTime ?easting ?northing ?latitude ?longitude ?obs {  ?obs a irpsens:LocationDeviceObservation;    ssn:featureOfInterest ?j.   ?j transport:line <%s>;   transit:direction "%s"^^xsd:string;   user:user <%s>.   ?obs irpsens:serverTimestamp ?serverTime.   ?obs ssn:observationResult/ssn:hasValue ?value.  ?value  geo:lat ?latitude;  geo:long ?longitude;     spatialrelations:easting ?easting;    spatialrelations:northing ?northing. } order by desc(?serverTime) limit 1
ObservationQueries.locationDevice.get.line.userLatestMappedMatched=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX user: <http://www.dotrural.ac.uk/irp/uploads/ontologies/user/> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/>  PREFIX transit: <http://vocab.org/transit/terms/>  PREFIX transport: <http://www.dotrural.ac.uk/irp/uploads/ontologies/transport/>  PREFIX prov: <http://www.w3.org/ns/prov#> SELECT  ?serverTime ?easting ?northing ?latitude ?longitude ?obs ?derivedFrom {  ?obs a irpsens:MapMatchedLocationObservation;    ssn:featureOfInterest <%s>;  prov:wasDerivedFrom ?derivedFrom. <%s> transport:line <%s>;   transit:direction "%s"^^xsd:string;   user:user <%s>. ?obs ssn:observationResultTime ?serverTime.   ?obs ssn:observationResult/ssn:hasValue ?value.  ?value  geo:lat ?latitude;  geo:long ?longitude; spatialrelations:easting ?easting; spatialrelations:northing ?northing . } order by desc(?serverTime) limit 1
ObservationQueries.locationDevice.get.line.userLatestRaw=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX user: <http://www.dotrural.ac.uk/irp/uploads/ontologies/user/> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/>  PREFIX transit: <http://vocab.org/transit/terms/>  PREFIX transport: <http://www.dotrural.ac.uk/irp/uploads/ontologies/transport/>  PREFIX prov: <http://www.w3.org/ns/prov#> SELECT  ?serverTime ?easting ?northing ?latitude ?longitude ?obs  {  ?obs a irpsens:LocationDeviceObservation;    ssn:featureOfInterest <%s>. <%s> transport:line <%s>;   transit:direction "%s"^^xsd:string;   user:user <%s>. ?obs ssn:observationResultTime ?serverTime.   ?obs ssn:observationResult/ssn:hasValue ?value.  ?value  geo:lat ?latitude;  geo:long ?longitude; spatialrelations:easting ?easting; spatialrelations:northing ?northing. } order by desc(?serverTime) limit 1


# gets all the users who have contributed reports - line, direction, currentTime, offSet
ObservationQueries.locationDevice.get.line.usersInLast=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> PREFIX user: <http://www.dotrural.ac.uk/irp/uploads/ontologies/user/> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/> PREFIX transit: <http://vocab.org/transit/terms/> PREFIX transport: <http://www.dotrural.ac.uk/irp/uploads/ontologies/transport/> SELECT distinct ?user ?j {   ?obs a irpsens:LocationDeviceObservation;    ssn:featureOfInterest ?j.   ?j transport:line <%s>;   transit:direction "%s"^^xsd:string;   user:user ?user. ?obs irpsens:serverTimestamp ?serverTime.   filter (?serverTime > "%s"^^xsd:long).} 


# create a map matched location
ObservationQueries.mapmatchedlocation.update.create=PREFIX ssn: <http://purl.oclc.org/NET/ssnx/ssn#> PREFIX irpsens: <http://www.dotrural.ac.uk/irp/uploads/ontologies/sensors/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX spatialrelations: <http://data.ordnancesurvey.co.uk/ontology/spatialrelations/>  PREFIX prov: <http://www.w3.org/ns/prov#>  PREFIX dct: <http://purl.org/dc/elements/1.1/> INSERT DATA {   <%s> a irpsens:MapMatchedLocationValue;  geo:lat "%s"^^xsd:double;  geo:long "%s"^^xsd:double;   spatialrelations:easting "%s"^^xsd:double;  spatialrelations:northing "%s"^^xsd:double; irpsens:distanceMoved "%s"^^xsd:double; irpsens:accuracy "0"^^xsd:double; irpsens:nextNode [ dct:identifier "%s"^^xsd:string ].  <%s> a irpsens:MapMatchedLocationSensorOutput;  ssn:hasValue <%s>.   <%s> a irpsens:MapMatchedLocationObservation;  ssn:observationResult <%s>;    ssn:featureOfInterest <%s>;     ssn:observationResultTime "%s"^^xsd:long;    ssn:observationSamplingTime "%s"^^xsd:long; irpsens:serverTimestamp "%s"^^xsd:long; prov:wasDerivedFrom <%s>. }
